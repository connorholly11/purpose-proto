"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/layout",{

/***/ "(app-pages-browser)/./src/app/client-layout.tsx":
/*!***********************************!*\
  !*** ./src/app/client-layout.tsx ***!
  \***********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ ClientLayout; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _components_AppHeader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @components/AppHeader */ \"(app-pages-browser)/./src/components/AppHeader.tsx\");\n/* harmony import */ var _components_NavBar__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @components/NavBar */ \"(app-pages-browser)/./src/components/NavBar.tsx\");\n/* harmony import */ var _components_FeedbackButton__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @components/FeedbackButton */ \"(app-pages-browser)/./src/components/FeedbackButton.tsx\");\n/* harmony import */ var _context_ChatContext__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../context/ChatContext */ \"(app-pages-browser)/./src/context/ChatContext.tsx\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n\nfunction ClientLayout(param) {\n    let { children } = param;\n    _s();\n    const [isAdminMode, setIsAdminMode] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Effect to load admin mode from localStorage on mount\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        // On mount, check local storage\n        const storedMode = localStorage.getItem(\"adminMode\");\n        if (storedMode) {\n            setIsAdminMode(storedMode === \"true\");\n        }\n    }, []);\n    // Handler function to update both state and localStorage\n    const handleSetAdminMode = (value)=>{\n        setIsAdminMode(value);\n        localStorage.setItem(\"adminMode\", String(value));\n    };\n    // Navigation items\n    const navItems = [\n        {\n            name: \"AI Companion\",\n            path: \"/ai-companion\",\n            icon: \"chat-bubble\"\n        },\n        {\n            name: \"Quests\",\n            path: \"/quests\",\n            icon: \"emoji-events\"\n        },\n        {\n            name: \"Profile\",\n            path: \"/profile\",\n            icon: \"person\"\n        },\n        {\n            name: \"Dashboard\",\n            path: \"/dashboard\",\n            icon: \"dashboard\",\n            adminOnly: true\n        },\n        {\n            name: \"System Prompts\",\n            path: \"/prompts\",\n            icon: \"settings\",\n            adminOnly: true\n        },\n        {\n            name: \"Admin Tools\",\n            path: \"/admin\",\n            icon: \"admin-panel-settings\",\n            adminOnly: true\n        },\n        {\n            name: \"Testing\",\n            path: \"/testing\",\n            icon: \"science\",\n            adminOnly: true\n        },\n        {\n            name: \"Evaluations\",\n            path: \"/eval\",\n            icon: \"score\",\n            adminOnly: true\n        }\n    ];\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_context_ChatContext__WEBPACK_IMPORTED_MODULE_5__.ChatProvider, {\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_AppHeader__WEBPACK_IMPORTED_MODULE_2__.AdminContext.Provider, {\n            value: {\n                isAdminMode,\n                setIsAdminMode: handleSetAdminMode\n            },\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_AppHeader__WEBPACK_IMPORTED_MODULE_2__[\"default\"], {}, void 0, false, {\n                    fileName: \"/Users/connorholly/Downloads/purpose/gemini-plan-proto/frontend/src/app/client-layout.tsx\",\n                    lineNumber: 55,\n                    columnNumber: 9\n                }, this),\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"main\", {\n                    className: \"main-content\",\n                    children: children\n                }, void 0, false, {\n                    fileName: \"/Users/connorholly/Downloads/purpose/gemini-plan-proto/frontend/src/app/client-layout.tsx\",\n                    lineNumber: 56,\n                    columnNumber: 9\n                }, this),\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_NavBar__WEBPACK_IMPORTED_MODULE_3__.NavBar, {\n                    items: navItems,\n                    isAdminMode: isAdminMode\n                }, void 0, false, {\n                    fileName: \"/Users/connorholly/Downloads/purpose/gemini-plan-proto/frontend/src/app/client-layout.tsx\",\n                    lineNumber: 59,\n                    columnNumber: 9\n                }, this),\n                isAdminMode && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_FeedbackButton__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {}, void 0, false, {\n                    fileName: \"/Users/connorholly/Downloads/purpose/gemini-plan-proto/frontend/src/app/client-layout.tsx\",\n                    lineNumber: 60,\n                    columnNumber: 25\n                }, this)\n            ]\n        }, void 0, true, {\n            fileName: \"/Users/connorholly/Downloads/purpose/gemini-plan-proto/frontend/src/app/client-layout.tsx\",\n            lineNumber: 54,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"/Users/connorholly/Downloads/purpose/gemini-plan-proto/frontend/src/app/client-layout.tsx\",\n        lineNumber: 53,\n        columnNumber: 5\n    }, this);\n}\n_s(ClientLayout, \"FATiM5AU8SWV/T2Ybuvkah7KCY0=\");\n_c = ClientLayout;\nvar _c;\n$RefreshReg$(_c, \"ClientLayout\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9hcHAvY2xpZW50LWxheW91dC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUVtRDtBQUNFO0FBQ1A7QUFDRjtBQUNZO0FBQ0Y7QUFVdkMsU0FBU1EsYUFBYSxLQUlwQztRQUpvQyxFQUNuQ0MsUUFBUSxFQUdULEdBSm9DOztJQUtuQyxNQUFNLENBQUNDLGFBQWFDLGVBQWUsR0FBR1YsK0NBQVFBLENBQUM7SUFFL0MsdURBQXVEO0lBQ3ZEQyxnREFBU0EsQ0FBQztRQUNSLGdDQUFnQztRQUNoQyxNQUFNVSxhQUFhQyxhQUFhQyxPQUFPLENBQUM7UUFDeEMsSUFBSUYsWUFBWTtZQUNkRCxlQUFlQyxlQUFlO1FBQ2hDO0lBQ0YsR0FBRyxFQUFFO0lBRUwseURBQXlEO0lBQ3pELE1BQU1HLHFCQUFxQixDQUFDQztRQUMxQkwsZUFBZUs7UUFDZkgsYUFBYUksT0FBTyxDQUFDLGFBQWFDLE9BQU9GO0lBQzNDO0lBRUEsbUJBQW1CO0lBQ25CLE1BQU1HLFdBQXNCO1FBQzFCO1lBQUVDLE1BQU07WUFBZ0JDLE1BQU07WUFBaUJDLE1BQU07UUFBYztRQUNuRTtZQUFFRixNQUFNO1lBQVVDLE1BQU07WUFBV0MsTUFBTTtRQUFlO1FBQ3hEO1lBQUVGLE1BQU07WUFBV0MsTUFBTTtZQUFZQyxNQUFNO1FBQVM7UUFDcEQ7WUFBRUYsTUFBTTtZQUFhQyxNQUFNO1lBQWNDLE1BQU07WUFBYUMsV0FBVztRQUFLO1FBQzVFO1lBQUVILE1BQU07WUFBa0JDLE1BQU07WUFBWUMsTUFBTTtZQUFZQyxXQUFXO1FBQUs7UUFDOUU7WUFBRUgsTUFBTTtZQUFlQyxNQUFNO1lBQVVDLE1BQU07WUFBd0JDLFdBQVc7UUFBSztRQUNyRjtZQUFFSCxNQUFNO1lBQVdDLE1BQU07WUFBWUMsTUFBTTtZQUFXQyxXQUFXO1FBQUs7UUFDdEU7WUFBRUgsTUFBTTtZQUFlQyxNQUFNO1lBQVNDLE1BQU07WUFBU0MsV0FBVztRQUFLO0tBQ3RFO0lBRUQscUJBQ0UsOERBQUNoQiw4REFBWUE7a0JBQ1gsNEVBQUNKLCtEQUFZQSxDQUFDcUIsUUFBUTtZQUFDUixPQUFPO2dCQUFFTjtnQkFBYUMsZ0JBQWdCSTtZQUFtQjs7OEJBQzlFLDhEQUFDWCw2REFBU0E7Ozs7OzhCQUNWLDhEQUFDcUI7b0JBQUtDLFdBQVU7OEJBQ2JqQjs7Ozs7OzhCQUVILDhEQUFDSixzREFBTUE7b0JBQUNzQixPQUFPUjtvQkFBVVQsYUFBYUE7Ozs7OztnQkFDckNBLDZCQUFlLDhEQUFDSixrRUFBY0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUFJdkM7R0E5Q3dCRTtLQUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvYXBwL2NsaWVudC1sYXlvdXQudHN4PzYyZTgiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBjbGllbnQnO1xuXG5pbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEFkbWluQ29udGV4dCB9IGZyb20gJ0Bjb21wb25lbnRzL0FwcEhlYWRlcic7XG5pbXBvcnQgQXBwSGVhZGVyIGZyb20gJ0Bjb21wb25lbnRzL0FwcEhlYWRlcic7XG5pbXBvcnQgeyBOYXZCYXIgfSBmcm9tICdAY29tcG9uZW50cy9OYXZCYXInO1xuaW1wb3J0IEZlZWRiYWNrQnV0dG9uIGZyb20gJ0Bjb21wb25lbnRzL0ZlZWRiYWNrQnV0dG9uJztcbmltcG9ydCB7IENoYXRQcm92aWRlciB9IGZyb20gJy4uL2NvbnRleHQvQ2hhdENvbnRleHQnO1xuXG4vLyBEZWZpbmUgTmF2SXRlbSBpbnRlcmZhY2VcbmludGVyZmFjZSBOYXZJdGVtIHtcbiAgbmFtZTogc3RyaW5nO1xuICBwYXRoOiBzdHJpbmc7XG4gIGljb246IHN0cmluZztcbiAgYWRtaW5Pbmx5PzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQ2xpZW50TGF5b3V0KHtcbiAgY2hpbGRyZW4sXG59OiB7XG4gIGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGU7XG59KSB7XG4gIGNvbnN0IFtpc0FkbWluTW9kZSwgc2V0SXNBZG1pbk1vZGVdID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIEVmZmVjdCB0byBsb2FkIGFkbWluIG1vZGUgZnJvbSBsb2NhbFN0b3JhZ2Ugb24gbW91bnRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBPbiBtb3VudCwgY2hlY2sgbG9jYWwgc3RvcmFnZVxuICAgIGNvbnN0IHN0b3JlZE1vZGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWRtaW5Nb2RlJyk7XG4gICAgaWYgKHN0b3JlZE1vZGUpIHtcbiAgICAgIHNldElzQWRtaW5Nb2RlKHN0b3JlZE1vZGUgPT09ICd0cnVlJyk7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgLy8gSGFuZGxlciBmdW5jdGlvbiB0byB1cGRhdGUgYm90aCBzdGF0ZSBhbmQgbG9jYWxTdG9yYWdlXG4gIGNvbnN0IGhhbmRsZVNldEFkbWluTW9kZSA9ICh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgIHNldElzQWRtaW5Nb2RlKHZhbHVlKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWRtaW5Nb2RlJywgU3RyaW5nKHZhbHVlKSk7XG4gIH07XG5cbiAgLy8gTmF2aWdhdGlvbiBpdGVtc1xuICBjb25zdCBuYXZJdGVtczogTmF2SXRlbVtdID0gW1xuICAgIHsgbmFtZTogJ0FJIENvbXBhbmlvbicsIHBhdGg6ICcvYWktY29tcGFuaW9uJywgaWNvbjogJ2NoYXQtYnViYmxlJyB9LFxuICAgIHsgbmFtZTogJ1F1ZXN0cycsIHBhdGg6ICcvcXVlc3RzJywgaWNvbjogJ2Vtb2ppLWV2ZW50cycgfSxcbiAgICB7IG5hbWU6ICdQcm9maWxlJywgcGF0aDogJy9wcm9maWxlJywgaWNvbjogJ3BlcnNvbicgfSxcbiAgICB7IG5hbWU6ICdEYXNoYm9hcmQnLCBwYXRoOiAnL2Rhc2hib2FyZCcsIGljb246ICdkYXNoYm9hcmQnLCBhZG1pbk9ubHk6IHRydWUgfSxcbiAgICB7IG5hbWU6ICdTeXN0ZW0gUHJvbXB0cycsIHBhdGg6ICcvcHJvbXB0cycsIGljb246ICdzZXR0aW5ncycsIGFkbWluT25seTogdHJ1ZSB9LFxuICAgIHsgbmFtZTogJ0FkbWluIFRvb2xzJywgcGF0aDogJy9hZG1pbicsIGljb246ICdhZG1pbi1wYW5lbC1zZXR0aW5ncycsIGFkbWluT25seTogdHJ1ZSB9LFxuICAgIHsgbmFtZTogJ1Rlc3RpbmcnLCBwYXRoOiAnL3Rlc3RpbmcnLCBpY29uOiAnc2NpZW5jZScsIGFkbWluT25seTogdHJ1ZSB9LFxuICAgIHsgbmFtZTogJ0V2YWx1YXRpb25zJywgcGF0aDogJy9ldmFsJywgaWNvbjogJ3Njb3JlJywgYWRtaW5Pbmx5OiB0cnVlIH0sXG4gIF07XG5cbiAgcmV0dXJuIChcbiAgICA8Q2hhdFByb3ZpZGVyPlxuICAgICAgPEFkbWluQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17eyBpc0FkbWluTW9kZSwgc2V0SXNBZG1pbk1vZGU6IGhhbmRsZVNldEFkbWluTW9kZSB9fT5cbiAgICAgICAgPEFwcEhlYWRlciAvPlxuICAgICAgICA8bWFpbiBjbGFzc05hbWU9XCJtYWluLWNvbnRlbnRcIj5cbiAgICAgICAgICB7Y2hpbGRyZW59XG4gICAgICAgIDwvbWFpbj5cbiAgICAgICAgPE5hdkJhciBpdGVtcz17bmF2SXRlbXN9IGlzQWRtaW5Nb2RlPXtpc0FkbWluTW9kZX0gLz5cbiAgICAgICAge2lzQWRtaW5Nb2RlICYmIDxGZWVkYmFja0J1dHRvbiAvPn1cbiAgICAgIDwvQWRtaW5Db250ZXh0LlByb3ZpZGVyPlxuICAgIDwvQ2hhdFByb3ZpZGVyPlxuICApO1xufSJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZVN0YXRlIiwidXNlRWZmZWN0IiwiQWRtaW5Db250ZXh0IiwiQXBwSGVhZGVyIiwiTmF2QmFyIiwiRmVlZGJhY2tCdXR0b24iLCJDaGF0UHJvdmlkZXIiLCJDbGllbnRMYXlvdXQiLCJjaGlsZHJlbiIsImlzQWRtaW5Nb2RlIiwic2V0SXNBZG1pbk1vZGUiLCJzdG9yZWRNb2RlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImhhbmRsZVNldEFkbWluTW9kZSIsInZhbHVlIiwic2V0SXRlbSIsIlN0cmluZyIsIm5hdkl0ZW1zIiwibmFtZSIsInBhdGgiLCJpY29uIiwiYWRtaW5Pbmx5IiwiUHJvdmlkZXIiLCJtYWluIiwiY2xhc3NOYW1lIiwiaXRlbXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/app/client-layout.tsx\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/context/ChatContext.tsx":
/*!*************************************!*\
  !*** ./src/context/ChatContext.tsx ***!
  \*************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChatProvider: function() { return /* binding */ ChatProvider; },\n/* harmony export */   useChatContext: function() { return /* binding */ useChatContext; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _hooks_useApi__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../hooks/useApi */ \"(app-pages-browser)/./src/hooks/useApi.ts\");\n\nvar _s = $RefreshSig$(), _s1 = $RefreshSig$();\n\n // Import the hook\n// Create the context with default values\nconst ChatContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)({\n    messages: [],\n    loading: false,\n    error: null,\n    debugInfo: null,\n    conversationId: null,\n    currentModel: null,\n    conversationCost: 0,\n    sendMessage: async ()=>{},\n    clearMessages: ()=>{},\n    startNewConversation: ()=>{}\n});\n// ChatProvider component to wrap the app with chat functionality\n// Helper function to calculate cost based on model and token count\nconst calculateCost = (modelName, inputTokens, outputTokens)=>{\n    // Convert tokens to millions for calculation\n    const inputMillions = inputTokens / 1000000;\n    const outputMillions = outputTokens / 1000000;\n    // Set rates based on model\n    if (modelName.toLowerCase().includes(\"claude\")) {\n        // Claude 3.5 Sonnet pricing\n        const inputRate = 3; // $3 per million tokens\n        const outputRate = 15; // $15 per million tokens\n        return inputMillions * inputRate + outputMillions * outputRate;\n    } else if (modelName.toLowerCase().includes(\"gpt\")) {\n        // GPT-4 pricing\n        const inputRate = 2.5; // $2.50 per million tokens\n        const outputRate = 10; // $10 per million tokens\n        return inputMillions * inputRate + outputMillions * outputRate;\n    }\n    // Default pricing for unknown models\n    return 0;\n};\n// Estimate token count for English text\nconst estimateTokenCount = (text)=>{\n    // Simple estimate: ~3/4 token per word for English\n    const wordCount = text.split(/\\s+/).length;\n    return Math.ceil(wordCount * 1.33);\n};\nconst ChatProvider = (param)=>{\n    let { children } = param;\n    _s();\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [debugInfo, setDebugInfo] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null); // State for debug info\n    const [conversationId, setConversationId] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null); // Track current conversation ID\n    const [currentModel, setCurrentModel] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null); // Track current model\n    const [conversationCost, setConversationCost] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0); // Track conversation cost\n    // API instance\n    const api = (0,_hooks_useApi__WEBPACK_IMPORTED_MODULE_2__.useApi)(); // Use the hook\n    // Send a message to the AI and get a response\n    const sendMessage = async function(content, overridePromptId) {\n        let requestDebugInfo = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : false, useContext = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : true // <-- Receive context toggle option (default to true)\n        ;\n        // Don't send if already loading\n        if (loading) {\n            console.log(\"[ChatContext] Skipping message send - already loading\");\n            return;\n        }\n        console.log(\"[ChatContext] Preparing to send message:\\n    - Content length: \".concat(content.length, \" chars\\n    - Override Prompt ID: \").concat(overridePromptId || \"None\", \"\\n    - Request Debug Info: \").concat(requestDebugInfo, \"\\n    - Use Context: \").concat(useContext, \"\\n    - Current Conversation ID: \").concat(conversationId || \"New conversation\"));\n        try {\n            var _response_debugInfo, _response_debugInfo1;\n            setLoading(true);\n            setError(null);\n            setDebugInfo(null); // Clear previous debug info\n            // Generate unique ID for user message with added randomness\n            const userMessageId = \"user-\".concat(Date.now(), \"-\").concat(Math.random().toString(36).slice(2));\n            console.log(\"[ChatContext] Generated user message ID: \".concat(userMessageId));\n            // Estimate token count for user message\n            const estimatedUserTokens = estimateTokenCount(content);\n            // Create user message object with token count\n            const userMessage = {\n                id: userMessageId,\n                content,\n                role: \"user\",\n                createdAt: new Date().toISOString(),\n                tokenCount: {\n                    input: estimatedUserTokens\n                },\n                modelName: currentModel || undefined\n            };\n            // Add user message to the messages array immediately\n            console.log(\"[ChatContext] Adding user message to UI\");\n            setMessages((prevMessages)=>{\n                const newMessages = [\n                    ...prevMessages,\n                    userMessage\n                ];\n                console.log(\"[ChatContext] After adding user message - array size: \".concat(newMessages.length));\n                return newMessages;\n            });\n            // Make the API call to get a response, passing debug options and conversationId\n            console.log(\"[ChatContext] Calling API to send message\");\n            console.log('[ChatContext] User message content: \"'.concat(content, '\"'));\n            // Set requestDebugInfo to true to get system prompt and model info\n            const enhancedDebugInfo = true;\n            const response = await api.chat.sendMessage(content, overridePromptId, enhancedDebugInfo, useContext, conversationId // <-- Pass the current conversation ID (null for new)\n            );\n            console.log(\"[ChatContext] Response received:\\n      - Response length: \".concat(response.reply.length, \" chars\\n      - Conversation ID: \").concat(response.conversationId, \"\\n      - Is New Conversation: \").concat(response.isNewConversation, \"\\n      - Debug info included: \").concat(Boolean(response.debugInfo)));\n            // Log AI response content for debugging\n            console.log('[ChatContext] AI response: \"'.concat(response.reply.substring(0, 100)).concat(response.reply.length > 100 ? \"...\" : \"\", '\"'));\n            // Log system prompt and model information if available\n            if (response.debugInfo) {\n                var _response_debugInfo_conversation;\n                console.log('[ChatContext] System prompt: \"'.concat(response.debugInfo.systemPromptUsedName, '\"'));\n                console.log('[ChatContext] Model used: \"'.concat(response.debugInfo.modelName || \"Default model\", '\"'));\n                console.log(\"[ChatContext] Conversation history: \".concat(((_response_debugInfo_conversation = response.debugInfo.conversation) === null || _response_debugInfo_conversation === void 0 ? void 0 : _response_debugInfo_conversation.messageCount) || 0, \" previous messages\"));\n                // Log if context was injected\n                if (response.debugInfo.summaryContextInjected) {\n                    console.log(\"[ChatContext] Context injected: Yes (\".concat(response.debugInfo.summaryContextInjected.length, \" chars)\"));\n                } else {\n                    console.log(\"[ChatContext] Context injected: No\");\n                }\n            }\n            // Always update conversationId from response to ensure consistency\n            console.log(\"[ChatContext] \".concat(!conversationId ? \"Setting\" : \"Updating\", \" conversation ID to: \").concat(response.conversationId));\n            setConversationId(response.conversationId);\n            // Log if this is a new conversation for debugging\n            if (response.isNewConversation) {\n                console.log(\"[ChatContext] Server indicated this is a new conversation\");\n            }\n            // Update current model if available in debug info\n            if ((_response_debugInfo = response.debugInfo) === null || _response_debugInfo === void 0 ? void 0 : _response_debugInfo.modelName) {\n                console.log(\"[ChatContext] Setting current model to: \".concat(response.debugInfo.modelName));\n                setCurrentModel(response.debugInfo.modelName);\n            }\n            // Estimate token count for AI response\n            const estimatedOutputTokens = estimateTokenCount(response.reply);\n            // Create AI message object with token count\n            const aiMessage = {\n                id: \"assistant-\".concat(Date.now(), \"-\").concat(Math.random().toString(36).slice(2)),\n                content: response.reply,\n                role: \"assistant\",\n                createdAt: new Date().toISOString(),\n                tokenCount: {\n                    output: estimatedOutputTokens\n                },\n                modelName: ((_response_debugInfo1 = response.debugInfo) === null || _response_debugInfo1 === void 0 ? void 0 : _response_debugInfo1.modelName) || currentModel || undefined\n            };\n            // Safely update conversation cost using a try-catch to handle any errors\n            try {\n                var _response_debugInfo2, _response_debugInfo3;\n                // Update conversation cost if we have debug info with cost estimate\n                if ((_response_debugInfo2 = response.debugInfo) === null || _response_debugInfo2 === void 0 ? void 0 : _response_debugInfo2.costEstimate) {\n                    var _response_debugInfo4;\n                    const messageCost = response.debugInfo.costEstimate;\n                    console.log(\"[ChatContext] Server message cost estimate: $\".concat(messageCost.toFixed(6)));\n                    if ((_response_debugInfo4 = response.debugInfo) === null || _response_debugInfo4 === void 0 ? void 0 : _response_debugInfo4.tokenUsage) {\n                        console.log(\"[ChatContext] Token usage: \".concat(response.debugInfo.tokenUsage.promptTokens, \" prompt tokens, \").concat(response.debugInfo.tokenUsage.completionTokens, \" completion tokens\"));\n                    }\n                    // Update total conversation cost\n                    setConversationCost((prevCost)=>{\n                        const newCost = prevCost + messageCost;\n                        console.log(\"[ChatContext] Updated conversation cost: $\".concat(newCost.toFixed(6)));\n                        return newCost;\n                    });\n                } else if (((_response_debugInfo3 = response.debugInfo) === null || _response_debugInfo3 === void 0 ? void 0 : _response_debugInfo3.modelName) || currentModel) {\n                    var _response_debugInfo5;\n                    const modelToUse = ((_response_debugInfo5 = response.debugInfo) === null || _response_debugInfo5 === void 0 ? void 0 : _response_debugInfo5.modelName) || currentModel || \"\";\n                    const inputTokens = estimatedUserTokens;\n                    const outputTokens = estimatedOutputTokens;\n                    // Calculate message cost\n                    const messageCost = calculateCost(modelToUse, inputTokens, outputTokens);\n                    console.log(\"[ChatContext] Client message cost estimate: $\".concat(messageCost.toFixed(6), \" (\").concat(inputTokens, \" input tokens, \").concat(outputTokens, \" output tokens)\"));\n                    // Update total conversation cost\n                    setConversationCost((prevCost)=>{\n                        const newCost = prevCost + messageCost;\n                        console.log(\"[ChatContext] Updated conversation cost: $\".concat(newCost.toFixed(6)));\n                        return newCost;\n                    });\n                } else {\n                    // If we can't estimate cost, just log a message\n                    console.log(\"[ChatContext] Unable to estimate message cost - insufficient data\");\n                }\n            } catch (costError) {\n                // If anything goes wrong in cost calculation, just log and continue\n                console.error(\"[ChatContext] Error calculating message cost:\", costError);\n            }\n            // Add AI message to the messages array\n            console.log(\"[ChatContext] Adding AI response to UI\");\n            setMessages((prevMessages)=>{\n                const newMessages = [\n                    ...prevMessages,\n                    aiMessage\n                ];\n                console.log(\"[ChatContext] Updated messages array size: \".concat(newMessages.length));\n                console.log(\"[ChatContext] Latest message ID: \".concat(aiMessage.id));\n                return newMessages;\n            });\n            // Set debug info if requested and received\n            if (requestDebugInfo && response.debugInfo) {\n                console.log(\"[ChatContext] Setting debug info in state\");\n                setDebugInfo(response.debugInfo);\n            }\n        } catch (err) {\n            var _err_response_data, _err_response;\n            console.error(\"[ChatContext] Error sending message:\", err);\n            const errorMessage = ((_err_response = err.response) === null || _err_response === void 0 ? void 0 : (_err_response_data = _err_response.data) === null || _err_response_data === void 0 ? void 0 : _err_response_data.message) || err.message || \"Failed to get a response from the AI. Please try again.\";\n            console.error(\"[ChatContext] Setting error: \".concat(errorMessage));\n            setError(errorMessage);\n        // Optionally remove the user message if the API call failed\n        // setMessages(prevMessages => prevMessages.filter(msg => msg.id !== userMessageId));\n        } finally{\n            console.log(\"[ChatContext] Message exchange complete, setting loading to false\");\n            setLoading(false);\n        }\n    };\n    // Clear all messages\n    const clearMessages = ()=>{\n        setMessages([]);\n        setError(null);\n        setDebugInfo(null); // Clear debug info as well\n    };\n    // Start a new conversation\n    const startNewConversation = ()=>{\n        console.log(\"[ChatContext] Starting new conversation - resetting state\");\n        console.log(\"[ChatContext] Previous conversation ID: \".concat(conversationId || \"None\"));\n        setConversationId(null); // This will signal the backend to start a fresh conversation\n        setMessages([]); // Clear the UI\n        setError(null);\n        setDebugInfo(null);\n        setConversationCost(0); // Reset conversation cost\n        // Keep the current model info for the next conversation\n        console.log(\"[ChatContext] State reset complete for new conversation\");\n    };\n    // Context value\n    const value = {\n        messages,\n        loading,\n        debugInfo,\n        error,\n        conversationId,\n        currentModel,\n        conversationCost,\n        sendMessage,\n        clearMessages,\n        startNewConversation\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(ChatContext.Provider, {\n        value: value,\n        children: children\n    }, void 0, false, {\n        fileName: \"/Users/connorholly/Downloads/purpose/gemini-plan-proto/frontend/src/context/ChatContext.tsx\",\n        lineNumber: 354,\n        columnNumber: 10\n    }, undefined);\n};\n_s(ChatProvider, \"qpAj09b2F97ctlymJtOm/HwzSKU=\", false, function() {\n    return [\n        _hooks_useApi__WEBPACK_IMPORTED_MODULE_2__.useApi\n    ];\n});\n_c = ChatProvider;\n// Custom hook to use the chat context\nconst useChatContext = ()=>{\n    _s1();\n    return (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(ChatContext);\n};\n_s1(useChatContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n/* harmony default export */ __webpack_exports__[\"default\"] = (ChatContext);\nvar _c;\n$RefreshReg$(_c, \"ChatProvider\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb250ZXh0L0NoYXRDb250ZXh0LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUE4RTtBQUNyQyxDQUFDLGtCQUFrQjtBQTZENUQseUNBQXlDO0FBQ3pDLE1BQU1LLDRCQUFjSixvREFBYUEsQ0FBa0I7SUFDakRLLFVBQVUsRUFBRTtJQUNaQyxTQUFTO0lBQ1RDLE9BQU87SUFDUEMsV0FBVztJQUNYQyxnQkFBZ0I7SUFDaEJDLGNBQWM7SUFDZEMsa0JBQWtCO0lBQ2xCQyxhQUFhLFdBQWE7SUFDMUJDLGVBQWUsS0FBTztJQUN0QkMsc0JBQXNCLEtBQU87QUFDL0I7QUFPQSxpRUFBaUU7QUFDakUsbUVBQW1FO0FBQ25FLE1BQU1DLGdCQUFnQixDQUFDQyxXQUFtQkMsYUFBcUJDO0lBQzdELDZDQUE2QztJQUM3QyxNQUFNQyxnQkFBZ0JGLGNBQWM7SUFDcEMsTUFBTUcsaUJBQWlCRixlQUFlO0lBRXRDLDJCQUEyQjtJQUMzQixJQUFJRixVQUFVSyxXQUFXLEdBQUdDLFFBQVEsQ0FBQyxXQUFXO1FBQzlDLDRCQUE0QjtRQUM1QixNQUFNQyxZQUFZLEdBQUcsd0JBQXdCO1FBQzdDLE1BQU1DLGFBQWEsSUFBSSx5QkFBeUI7UUFDaEQsT0FBTyxnQkFBaUJELFlBQWNILGlCQUFpQkk7SUFDekQsT0FBTyxJQUFJUixVQUFVSyxXQUFXLEdBQUdDLFFBQVEsQ0FBQyxRQUFRO1FBQ2xELGdCQUFnQjtRQUNoQixNQUFNQyxZQUFZLEtBQUssMkJBQTJCO1FBQ2xELE1BQU1DLGFBQWEsSUFBSSx5QkFBeUI7UUFDaEQsT0FBTyxnQkFBaUJELFlBQWNILGlCQUFpQkk7SUFDekQ7SUFFQSxxQ0FBcUM7SUFDckMsT0FBTztBQUNUO0FBRUEsd0NBQXdDO0FBQ3hDLE1BQU1DLHFCQUFxQixDQUFDQztJQUMxQixtREFBbUQ7SUFDbkQsTUFBTUMsWUFBWUQsS0FBS0UsS0FBSyxDQUFDLE9BQU9DLE1BQU07SUFDMUMsT0FBT0MsS0FBS0Ms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QUNadkY7UUFDQUM7UUFDQUU7UUFDQUQ7UUFDQUU7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7UUFDQUM7SUFDRjtJQUVBLHFCQUFPLDhEQUFDVixZQUFZeUYsUUFBUTtRQUFDRCxPQUFPQTtrQkFBUTNEOzs7Ozs7QUFDOUMsRUFBRTtHQWxQV0Q7O1FBVUM3QixpREFBTUE7OztLQVZQNkI7QUFvUGIsc0NBQXNDO0FBQy9CLE1BQU04RCxpQkFBaUI7O0lBQU01RixPQUFBQSxpREFBVUEsQ0FBQ0U7QUFBVyxFQUFFO0lBQS9DMEY7QUFFYiwrREFBZTFGLFdBQVdBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL2NvbnRleHQvQ2hhdENvbnRleHQudHN4PzUwODMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IGNyZWF0ZUNvbnRleHQsIHVzZVN0YXRlLCB1c2VDb250ZXh0LCBSZWFjdE5vZGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VBcGkgfSBmcm9tICcuLi9ob29rcy91c2VBcGknOyAvLyBJbXBvcnQgdGhlIGhvb2tcblxuLy8gTWVzc2FnZSB0eXBlIGRlZmluaXRpb25cbmV4cG9ydCB0eXBlIE1lc3NhZ2UgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCc7XG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xuICAvLyBPcHRpb25hbCB0b2tlbiBlc3RpbWF0ZXMgZm9yIGNvc3QgY2FsY3VsYXRpb25cbiAgdG9rZW5Db3VudD86IHtcbiAgICBpbnB1dD86IG51bWJlcjtcbiAgICBvdXRwdXQ/OiBudW1iZXI7XG4gIH07XG4gIC8vIE9wdGlvbmFsIG1vZGVsIG5hbWUgZm9yIGNvc3QgY2FsY3VsYXRpb25cbiAgbW9kZWxOYW1lPzogc3RyaW5nO1xufTtcblxuLy8gRGVidWcgcmVzcG9uc2UgdHlwZSBmcm9tIGJhY2tlbmRcbnR5cGUgRGVidWdJbmZvID0ge1xuICB0aW1lc3RhbXA6IHN0cmluZztcbiAgc3lzdGVtUHJvbXB0VXNlZElkOiBzdHJpbmc7XG4gIHN5c3RlbVByb21wdFVzZWROYW1lOiBzdHJpbmc7XG4gIHN1bW1hcnlDb250ZXh0SW5qZWN0ZWQ6IHN0cmluZztcbiAgbW9kZWxOYW1lPzogc3RyaW5nO1xuICB0b2tlblVzYWdlPzoge1xuICAgIHByb21wdFRva2Vucz86IG51bWJlcjtcbiAgICBjb21wbGV0aW9uVG9rZW5zPzogbnVtYmVyO1xuICAgIHRvdGFsVG9rZW5zPzogbnVtYmVyO1xuICB9O1xuICBtZXNzYWdlcz86IHtcbiAgICB1c2VyTWVzc2FnZVByZXZpZXc/OiBzdHJpbmc7XG4gICAgYWlSZXNwb25zZVByZXZpZXc/OiBzdHJpbmc7XG4gIH07XG4gIGNvbnZlcnNhdGlvbj86IHtcbiAgICBpZD86IHN0cmluZztcbiAgICBpc05ld0NvbnZlcnNhdGlvbj86IGJvb2xlYW47XG4gICAgbWVzc2FnZUNvdW50PzogbnVtYmVyO1xuICAgIHRvdGFsUHJvbXB0TWVzc2FnZXM/OiBudW1iZXI7XG4gIH07XG4gIGNvc3RFc3RpbWF0ZT86IG51bWJlcjtcbn07XG5cbi8vIENoYXRDb250ZXh0IHR5cGUgZGVmaW5pdGlvblxudHlwZSBDaGF0Q29udGV4dFR5cGUgPSB7XG4gIG1lc3NhZ2VzOiBNZXNzYWdlW107XG4gIGxvYWRpbmc6IGJvb2xlYW47XG4gIGVycm9yOiBzdHJpbmcgfCBudWxsO1xuICBkZWJ1Z0luZm86IERlYnVnSW5mbyB8IG51bGw7IC8vIEFkZCBkZWJ1Z0luZm8gc3RhdGVcbiAgY29udmVyc2F0aW9uSWQ6IHN0cmluZyB8IG51bGw7IC8vIFRyYWNrIHRoZSBjdXJyZW50IGNvbnZlcnNhdGlvbiBJRFxuICBjdXJyZW50TW9kZWw6IHN0cmluZyB8IG51bGw7IC8vIEN1cnJlbnQgbW9kZWwgYmVpbmcgdXNlZFxuICBjb252ZXJzYXRpb25Db3N0OiBudW1iZXI7IC8vIFRyYWNrIHRoZSBjb3N0IG9mIHRoZSBjb252ZXJzYXRpb25cbiAgc2VuZE1lc3NhZ2U6IChcbiAgICBjb250ZW50OiBzdHJpbmcsXG4gICAgb3ZlcnJpZGVQcm9tcHRJZD86IHN0cmluZywgLy8gQWRkIGRlYnVnIG9wdGlvblxuICAgIHJlcXVlc3REZWJ1Z0luZm8/OiBib29sZWFuLCAvLyBBZGQgZGVidWcgb3B0aW9uXG4gICAgdXNlQ29udGV4dD86IGJvb2xlYW4gLy8gPC0tIEFkZCBjb250ZXh0IHRvZ2dsZSBvcHRpb25cbiAgKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBjbGVhck1lc3NhZ2VzOiAoKSA9PiB2b2lkO1xuICBzdGFydE5ld0NvbnZlcnNhdGlvbjogKCkgPT4gdm9pZDsgLy8gTWV0aG9kIHRvIHN0YXJ0IGEgbmV3IGNvbnZlcnNhdGlvblxufTtcblxuLy8gQ3JlYXRlIHRoZSBjb250ZXh0IHdpdGggZGVmYXVsdCB2YWx1ZXNcbmNvbnN0IENoYXRDb250ZXh0ID0gY3JlYXRlQ29udGV4dDxDaGF0Q29udGV4dFR5cGU+KHtcbiAgbWVzc2FnZXM6IFtdLFxuICBsb2FkaW5nOiBmYWxzZSxcbiAgZXJyb3I6IG51bGwsXG4gIGRlYnVnSW5mbzogbnVsbCwgLy8gSW5pdGlhbGl6ZSBkZWJ1Z0luZm9cbiAgY29udmVyc2F0aW9uSWQ6IG51bGwsIC8vIEluaXRpYWxpemUgY29udmVyc2F0aW9uSWQgYXMgbnVsbFxuICBjdXJyZW50TW9kZWw6IG51bGwsIC8vIEluaXRpYWxpemUgY3VycmVudE1vZGVsIGFzIG51bGxcbiAgY29udmVyc2F0aW9uQ29zdDogMCwgLy8gSW5pdGlhbGl6ZSBjb252ZXJzYXRpb24gY29zdCBhcyAwXG4gIHNlbmRNZXNzYWdlOiBhc3luYyAoKSA9PiB7fSxcbiAgY2xlYXJNZXNzYWdlczogKCkgPT4ge30sXG4gIHN0YXJ0TmV3Q29udmVyc2F0aW9uOiAoKSA9PiB7fSwgLy8gSW5pdGlhbGl6ZSBzdGFydE5ld0NvbnZlcnNhdGlvblxufSk7XG5cbi8vIFByb3BzIGZvciB0aGUgQ2hhdFByb3ZpZGVyIGNvbXBvbmVudFxudHlwZSBDaGF0UHJvdmlkZXJQcm9wcyA9IHtcbiAgY2hpbGRyZW46IFJlYWN0Tm9kZTtcbn07XG5cbi8vIENoYXRQcm92aWRlciBjb21wb25lbnQgdG8gd3JhcCB0aGUgYXBwIHdpdGggY2hhdCBmdW5jdGlvbmFsaXR5XG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2FsY3VsYXRlIGNvc3QgYmFzZWQgb24gbW9kZWwgYW5kIHRva2VuIGNvdW50XG5jb25zdCBjYWxjdWxhdGVDb3N0ID0gKG1vZGVsTmFtZTogc3RyaW5nLCBpbnB1dFRva2VuczogbnVtYmVyLCBvdXRwdXRUb2tlbnM6IG51bWJlcik6IG51bWJlciA9PiB7XG4gIC8vIENvbnZlcnQgdG9rZW5zIHRvIG1pbGxpb25zIGZvciBjYWxjdWxhdGlvblxuICBjb25zdCBpbnB1dE1pbGxpb25zID0gaW5wdXRUb2tlbnMgLyAxMDAwMDAwO1xuICBjb25zdCBvdXRwdXRNaWxsaW9ucyA9IG91dHB1dFRva2VucyAvIDEwMDAwMDA7XG4gIFxuICAvLyBTZXQgcmF0ZXMgYmFzZWQgb24gbW9kZWxcbiAgaWYgKG1vZGVsTmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjbGF1ZGUnKSkge1xuICAgIC8vIENsYXVkZSAzLjUgU29ubmV0IHByaWNpbmdcbiAgICBjb25zdCBpbnB1dFJhdGUgPSAzOyAvLyAkMyBwZXIgbWlsbGlvbiB0b2tlbnNcbiAgICBjb25zdCBvdXRwdXRSYXRlID0gMTU7IC8vICQxNSBwZXIgbWlsbGlvbiB0b2tlbnNcbiAgICByZXR1cm4gKGlucHV0TWlsbGlvbnMgKiBpbnB1dFJhdGUpICsgKG91dHB1dE1pbGxpb25zICogb3V0cHV0UmF0ZSk7XG4gIH0gZWxzZSBpZiAobW9kZWxOYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2dwdCcpKSB7XG4gICAgLy8gR1BULTQgcHJpY2luZ1xuICAgIGNvbnN0IGlucHV0UmF0ZSA9IDIuNTsgLy8gJDIuNTAgcGVyIG1pbGxpb24gdG9rZW5zXG4gICAgY29uc3Qgb3V0cHV0UmF0ZSA9IDEwOyAvLyAkMTAgcGVyIG1pbGxpb24gdG9rZW5zXG4gICAgcmV0dXJuIChpbnB1dE1pbGxpb25zICogaW5wdXRSYXRlKSArIChvdXRwdXRNaWxsaW9ucyAqIG91dHB1dFJhdGUpO1xuICB9XG4gIFxuICAvLyBEZWZhdWx0IHByaWNpbmcgZm9yIHVua25vd24gbW9kZWxzXG4gIHJldHVybiAwO1xufTtcblxuLy8gRXN0aW1hdGUgdG9rZW4gY291bnQgZm9yIEVuZ2xpc2ggdGV4dFxuY29uc3QgZXN0aW1hdGVUb2tlbkNvdW50ID0gKHRleHQ6IHN0cmluZyk6IG51bWJlciA9PiB7XG4gIC8vIFNpbXBsZSBlc3RpbWF0ZTogfjMvNCB0b2tlbiBwZXIgd29yZCBmb3IgRW5nbGlzaFxuICBjb25zdCB3b3JkQ291bnQgPSB0ZXh0LnNwbGl0KC9cXHMrLykubGVuZ3RoO1xuICByZXR1cm4gTWF0aC5jZWlsKHdvcmRDb3VudCAqIDEuMzMpO1xufTtcblxuZXhwb3J0IGNvbnN0IENoYXRQcm92aWRlciA9ICh7IGNoaWxkcmVuIH06IENoYXRQcm92aWRlclByb3BzKSA9PiB7XG4gIGNvbnN0IFttZXNzYWdlcywgc2V0TWVzc2FnZXNdID0gdXNlU3RhdGU8TWVzc2FnZVtdPihbXSk7XG4gIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2RlYnVnSW5mbywgc2V0RGVidWdJbmZvXSA9IHVzZVN0YXRlPERlYnVnSW5mbyB8IG51bGw+KG51bGwpOyAvLyBTdGF0ZSBmb3IgZGVidWcgaW5mb1xuICBjb25zdCBbY29udmVyc2F0aW9uSWQsIHNldENvbnZlcnNhdGlvbklkXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpOyAvLyBUcmFjayBjdXJyZW50IGNvbnZlcnNhdGlvbiBJRFxuICBjb25zdCBbY3VycmVudE1vZGVsLCBzZXRDdXJyZW50TW9kZWxdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7IC8vIFRyYWNrIGN1cnJlbnQgbW9kZWxcbiAgY29uc3QgW2NvbnZlcnNhdGlvbkNvc3QsIHNldENvbnZlcnNhdGlvbkNvc3RdID0gdXNlU3RhdGU8bnVtYmVyPigwKTsgLy8gVHJhY2sgY29udmVyc2F0aW9uIGNvc3RcbiAgXG4gIC8vIEFQSSBpbnN0YW5jZVxuICBjb25zdCBhcGkgPSB1c2VBcGkoKTsgLy8gVXNlIHRoZSBob29rXG4gIFxuICAvLyBTZW5kIGEgbWVzc2FnZSB0byB0aGUgQUkgYW5kIGdldCBhIHJlc3BvbnNlXG4gIGNvbnN0IHNlbmRNZXNzYWdlID0gYXN5bmMgKFxuICAgIGNvbnRlbnQ6IHN0cmluZyxcbiAgICBvdmVycmlkZVByb21wdElkPzogc3RyaW5nLCAvLyBSZWNlaXZlIGRlYnVnIG9wdGlvblxuICAgIHJlcXVlc3REZWJ1Z0luZm8gPSBmYWxzZSwgLy8gUmVjZWl2ZSBkZWJ1ZyBvcHRpb25cbiAgICB1c2VDb250ZXh0ID0gdHJ1ZSAvLyA8LS0gUmVjZWl2ZSBjb250ZXh0IHRvZ2dsZSBvcHRpb24gKGRlZmF1bHQgdG8gdHJ1ZSlcbiAgKSA9PiB7XG4gICAgLy8gRG9uJ3Qgc2VuZCBpZiBhbHJlYWR5IGxvYWRpbmdcbiAgICBpZiAobG9hZGluZykge1xuICAgICAgY29uc29sZS5sb2coJ1tDaGF0Q29udGV4dF0gU2tpcHBpbmcgbWVzc2FnZSBzZW5kIC0gYWxyZWFkeSBsb2FkaW5nJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gUHJlcGFyaW5nIHRvIHNlbmQgbWVzc2FnZTpcbiAgICAtIENvbnRlbnQgbGVuZ3RoOiAke2NvbnRlbnQubGVuZ3RofSBjaGFyc1xuICAgIC0gT3ZlcnJpZGUgUHJvbXB0IElEOiAke292ZXJyaWRlUHJvbXB0SWQgfHwgJ05vbmUnfVxuICAgIC0gUmVxdWVzdCBEZWJ1ZyBJbmZvOiAke3JlcXVlc3REZWJ1Z0luZm99XG4gICAgLSBVc2UgQ29udGV4dDogJHt1c2VDb250ZXh0fVxuICAgIC0gQ3VycmVudCBDb252ZXJzYXRpb24gSUQ6ICR7Y29udmVyc2F0aW9uSWQgfHwgJ05ldyBjb252ZXJzYXRpb24nfWApO1xuXG4gICAgdHJ5IHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcbiAgICAgIHNldERlYnVnSW5mbyhudWxsKTsgLy8gQ2xlYXIgcHJldmlvdXMgZGVidWcgaW5mb1xuICAgICAgXG4gICAgICAvLyBHZW5lcmF0ZSB1bmlxdWUgSUQgZm9yIHVzZXIgbWVzc2FnZSB3aXRoIGFkZGVkIHJhbmRvbW5lc3NcbiAgICAgIGNvbnN0IHVzZXJNZXNzYWdlSWQgPSBgdXNlci0ke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMil9YDtcbiAgICAgIGNvbnNvbGUubG9nKGBbQ2hhdENvbnRleHRdIEdlbmVyYXRlZCB1c2VyIG1lc3NhZ2UgSUQ6ICR7dXNlck1lc3NhZ2VJZH1gKTtcbiAgICAgIFxuICAgICAgLy8gRXN0aW1hdGUgdG9rZW4gY291bnQgZm9yIHVzZXIgbWVzc2FnZVxuICAgICAgY29uc3QgZXN0aW1hdGVkVXNlclRva2VucyA9IGVzdGltYXRlVG9rZW5Db3VudChjb250ZW50KTtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHVzZXIgbWVzc2FnZSBvYmplY3Qgd2l0aCB0b2tlbiBjb3VudFxuICAgICAgY29uc3QgdXNlck1lc3NhZ2U6IE1lc3NhZ2UgPSB7XG4gICAgICAgIGlkOiB1c2VyTWVzc2FnZUlkLFxuICAgICAgICBjb250ZW50LFxuICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB0b2tlbkNvdW50OiB7XG4gICAgICAgICAgaW5wdXQ6IGVzdGltYXRlZFVzZXJUb2tlbnNcbiAgICAgICAgfSxcbiAgICAgICAgbW9kZWxOYW1lOiBjdXJyZW50TW9kZWwgfHwgdW5kZWZpbmVkXG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBBZGQgdXNlciBtZXNzYWdlIHRvIHRoZSBtZXNzYWdlcyBhcnJheSBpbW1lZGlhdGVseVxuICAgICAgY29uc29sZS5sb2coJ1tDaGF0Q29udGV4dF0gQWRkaW5nIHVzZXIgbWVzc2FnZSB0byBVSScpO1xuICAgICAgc2V0TWVzc2FnZXMocHJldk1lc3NhZ2VzID0+IHtcbiAgICAgICAgY29uc3QgbmV3TWVzc2FnZXMgPSBbLi4ucHJldk1lc3NhZ2VzLCB1c2VyTWVzc2FnZV07XG4gICAgICAgIGNvbnNvbGUubG9nKGBbQ2hhdENvbnRleHRdIEFmdGVyIGFkZGluZyB1c2VyIG1lc3NhZ2UgLSBhcnJheSBzaXplOiAke25ld01lc3NhZ2VzLmxlbmd0aH1gKTtcbiAgICAgICAgcmV0dXJuIG5ld01lc3NhZ2VzO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIE1ha2UgdGhlIEFQSSBjYWxsIHRvIGdldCBhIHJlc3BvbnNlLCBwYXNzaW5nIGRlYnVnIG9wdGlvbnMgYW5kIGNvbnZlcnNhdGlvbklkXG4gICAgICBjb25zb2xlLmxvZygnW0NoYXRDb250ZXh0XSBDYWxsaW5nIEFQSSB0byBzZW5kIG1lc3NhZ2UnKTtcbiAgICAgIGNvbnNvbGUubG9nKGBbQ2hhdENvbnRleHRdIFVzZXIgbWVzc2FnZSBjb250ZW50OiBcIiR7Y29udGVudH1cImApO1xuICAgICAgXG4gICAgICAvLyBTZXQgcmVxdWVzdERlYnVnSW5mbyB0byB0cnVlIHRvIGdldCBzeXN0ZW0gcHJvbXB0IGFuZCBtb2RlbCBpbmZvXG4gICAgICBjb25zdCBlbmhhbmNlZERlYnVnSW5mbyA9IHRydWU7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmNoYXQuc2VuZE1lc3NhZ2UoXG4gICAgICAgIGNvbnRlbnQsXG4gICAgICAgIG92ZXJyaWRlUHJvbXB0SWQsXG4gICAgICAgIGVuaGFuY2VkRGVidWdJbmZvLCAvLyBBbHdheXMgcmVxdWVzdCBkZWJ1ZyBpbmZvIGZvciBsb2dnaW5nXG4gICAgICAgIHVzZUNvbnRleHQsIC8vIDwtLSBQYXNzIGNvbnRleHQgdG9nZ2xlIHRvIEFQSSBzZXJ2aWNlXG4gICAgICAgIGNvbnZlcnNhdGlvbklkIC8vIDwtLSBQYXNzIHRoZSBjdXJyZW50IGNvbnZlcnNhdGlvbiBJRCAobnVsbCBmb3IgbmV3KVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gUmVzcG9uc2UgcmVjZWl2ZWQ6XG4gICAgICAtIFJlc3BvbnNlIGxlbmd0aDogJHtyZXNwb25zZS5yZXBseS5sZW5ndGh9IGNoYXJzXG4gICAgICAtIENvbnZlcnNhdGlvbiBJRDogJHtyZXNwb25zZS5jb252ZXJzYXRpb25JZH1cbiAgICAgIC0gSXMgTmV3IENvbnZlcnNhdGlvbjogJHtyZXNwb25zZS5pc05ld0NvbnZlcnNhdGlvbn1cbiAgICAgIC0gRGVidWcgaW5mbyBpbmNsdWRlZDogJHtCb29sZWFuKHJlc3BvbnNlLmRlYnVnSW5mbyl9YCk7XG4gICAgICBcbiAgICAgIC8vIExvZyBBSSByZXNwb25zZSBjb250ZW50IGZvciBkZWJ1Z2dpbmdcbiAgICAgIGNvbnNvbGUubG9nKGBbQ2hhdENvbnRleHRdIEFJIHJlc3BvbnNlOiBcIiR7cmVzcG9uc2UucmVwbHkuc3Vic3RyaW5nKDAsIDEwMCl9JHtyZXNwb25zZS5yZXBseS5sZW5ndGggPiAxMDAgPyAnLi4uJyA6ICcnfVwiYCk7XG4gICAgICBcbiAgICAgIC8vIExvZyBzeXN0ZW0gcHJvbXB0IGFuZCBtb2RlbCBpbmZvcm1hdGlvbiBpZiBhdmFpbGFibGVcbiAgICAgIGlmIChyZXNwb25zZS5kZWJ1Z0luZm8pIHtcbiAgICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gU3lzdGVtIHByb21wdDogXCIke3Jlc3BvbnNlLmRlYnVnSW5mby5zeXN0ZW1Qcm9tcHRVc2VkTmFtZX1cImApO1xuICAgICAgICBjb25zb2xlLmxvZyhgW0NoYXRDb250ZXh0XSBNb2RlbCB1c2VkOiBcIiR7cmVzcG9uc2UuZGVidWdJbmZvLm1vZGVsTmFtZSB8fCAnRGVmYXVsdCBtb2RlbCd9XCJgKTtcbiAgICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gQ29udmVyc2F0aW9uIGhpc3Rvcnk6ICR7cmVzcG9uc2UuZGVidWdJbmZvLmNvbnZlcnNhdGlvbj8ubWVzc2FnZUNvdW50IHx8IDB9IHByZXZpb3VzIG1lc3NhZ2VzYCk7XG4gICAgICAgIFxuICAgICAgICAvLyBMb2cgaWYgY29udGV4dCB3YXMgaW5qZWN0ZWRcbiAgICAgICAgaWYgKHJlc3BvbnNlLmRlYnVnSW5mby5zdW1tYXJ5Q29udGV4dEluamVjdGVkKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gQ29udGV4dCBpbmplY3RlZDogWWVzICgke3Jlc3BvbnNlLmRlYnVnSW5mby5zdW1tYXJ5Q29udGV4dEluamVjdGVkLmxlbmd0aH0gY2hhcnMpYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gQ29udGV4dCBpbmplY3RlZDogTm9gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBBbHdheXMgdXBkYXRlIGNvbnZlcnNhdGlvbklkIGZyb20gcmVzcG9uc2UgdG8gZW5zdXJlIGNvbnNpc3RlbmN5XG4gICAgICBjb25zb2xlLmxvZyhgW0NoYXRDb250ZXh0XSAkeyFjb252ZXJzYXRpb25JZCA/ICdTZXR0aW5nJyA6ICdVcGRhdGluZyd9IGNvbnZlcnNhdGlvbiBJRCB0bzogJHtyZXNwb25zZS5jb252ZXJzYXRpb25JZH1gKTtcbiAgICAgIHNldENvbnZlcnNhdGlvbklkKHJlc3BvbnNlLmNvbnZlcnNhdGlvbklkKTtcbiAgICAgIFxuICAgICAgLy8gTG9nIGlmIHRoaXMgaXMgYSBuZXcgY29udmVyc2F0aW9uIGZvciBkZWJ1Z2dpbmdcbiAgICAgIGlmIChyZXNwb25zZS5pc05ld0NvbnZlcnNhdGlvbikge1xuICAgICAgICBjb25zb2xlLmxvZyhgW0NoYXRDb250ZXh0XSBTZXJ2ZXIgaW5kaWNhdGVkIHRoaXMgaXMgYSBuZXcgY29udmVyc2F0aW9uYCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFVwZGF0ZSBjdXJyZW50IG1vZGVsIGlmIGF2YWlsYWJsZSBpbiBkZWJ1ZyBpbmZvXG4gICAgICBpZiAocmVzcG9uc2UuZGVidWdJbmZvPy5tb2RlbE5hbWUpIHtcbiAgICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gU2V0dGluZyBjdXJyZW50IG1vZGVsIHRvOiAke3Jlc3BvbnNlLmRlYnVnSW5mby5tb2RlbE5hbWV9YCk7XG4gICAgICAgIHNldEN1cnJlbnRNb2RlbChyZXNwb25zZS5kZWJ1Z0luZm8ubW9kZWxOYW1lKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gRXN0aW1hdGUgdG9rZW4gY291bnQgZm9yIEFJIHJlc3BvbnNlXG4gICAgICBjb25zdCBlc3RpbWF0ZWRPdXRwdXRUb2tlbnMgPSBlc3RpbWF0ZVRva2VuQ291bnQocmVzcG9uc2UucmVwbHkpO1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgQUkgbWVzc2FnZSBvYmplY3Qgd2l0aCB0b2tlbiBjb3VudFxuICAgICAgY29uc3QgYWlNZXNzYWdlOiBNZXNzYWdlID0ge1xuICAgICAgICBpZDogYGFzc2lzdGFudC0ke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMil9YCwgLy8gRW5zdXJlIHVuaXF1ZSBJRFxuICAgICAgICBjb250ZW50OiByZXNwb25zZS5yZXBseSxcbiAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB0b2tlbkNvdW50OiB7XG4gICAgICAgICAgb3V0cHV0OiBlc3RpbWF0ZWRPdXRwdXRUb2tlbnNcbiAgICAgICAgfSxcbiAgICAgICAgbW9kZWxOYW1lOiByZXNwb25zZS5kZWJ1Z0luZm8/Lm1vZGVsTmFtZSB8fCBjdXJyZW50TW9kZWwgfHwgdW5kZWZpbmVkXG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBTYWZlbHkgdXBkYXRlIGNvbnZlcnNhdGlvbiBjb3N0IHVzaW5nIGEgdHJ5LWNhdGNoIHRvIGhhbmRsZSBhbnkgZXJyb3JzXG4gICAgICB0cnkge1xuICAgICAgICAvLyBVcGRhdGUgY29udmVyc2F0aW9uIGNvc3QgaWYgd2UgaGF2ZSBkZWJ1ZyBpbmZvIHdpdGggY29zdCBlc3RpbWF0ZVxuICAgICAgICBpZiAocmVzcG9uc2UuZGVidWdJbmZvPy5jb3N0RXN0aW1hdGUpIHtcbiAgICAgICAgICBjb25zdCBtZXNzYWdlQ29zdCA9IHJlc3BvbnNlLmRlYnVnSW5mby5jb3N0RXN0aW1hdGU7XG4gICAgICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gU2VydmVyIG1lc3NhZ2UgY29zdCBlc3RpbWF0ZTogJCR7bWVzc2FnZUNvc3QudG9GaXhlZCg2KX1gKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAocmVzcG9uc2UuZGVidWdJbmZvPy50b2tlblVzYWdlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgW0NoYXRDb250ZXh0XSBUb2tlbiB1c2FnZTogJHtyZXNwb25zZS5kZWJ1Z0luZm8udG9rZW5Vc2FnZS5wcm9tcHRUb2tlbnN9IHByb21wdCB0b2tlbnMsICR7cmVzcG9uc2UuZGVidWdJbmZvLnRva2VuVXNhZ2UuY29tcGxldGlvblRva2Vuc30gY29tcGxldGlvbiB0b2tlbnNgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gVXBkYXRlIHRvdGFsIGNvbnZlcnNhdGlvbiBjb3N0XG4gICAgICAgICAgc2V0Q29udmVyc2F0aW9uQ29zdChwcmV2Q29zdCA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdDb3N0ID0gcHJldkNvc3QgKyBtZXNzYWdlQ29zdDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbQ2hhdENvbnRleHRdIFVwZGF0ZWQgY29udmVyc2F0aW9uIGNvc3Q6ICQke25ld0Nvc3QudG9GaXhlZCg2KX1gKTtcbiAgICAgICAgICAgIHJldHVybiBuZXdDb3N0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IFxuICAgICAgICAvLyBGYWxsYmFjayB0byBjbGllbnQtc2lkZSBlc3RpbWF0aW9uIGlmIG5vIHNlcnZlciBlc3RpbWF0ZSBhdmFpbGFibGVcbiAgICAgICAgZWxzZSBpZiAocmVzcG9uc2UuZGVidWdJbmZvPy5tb2RlbE5hbWUgfHwgY3VycmVudE1vZGVsKSB7XG4gICAgICAgICAgY29uc3QgbW9kZWxUb1VzZSA9IHJlc3BvbnNlLmRlYnVnSW5mbz8ubW9kZWxOYW1lIHx8IGN1cnJlbnRNb2RlbCB8fCAnJztcbiAgICAgICAgICBjb25zdCBpbnB1dFRva2VucyA9IGVzdGltYXRlZFVzZXJUb2tlbnM7XG4gICAgICAgICAgY29uc3Qgb3V0cHV0VG9rZW5zID0gZXN0aW1hdGVkT3V0cHV0VG9rZW5zO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIENhbGN1bGF0ZSBtZXNzYWdlIGNvc3RcbiAgICAgICAgICBjb25zdCBtZXNzYWdlQ29zdCA9IGNhbGN1bGF0ZUNvc3QobW9kZWxUb1VzZSwgaW5wdXRUb2tlbnMsIG91dHB1dFRva2Vucyk7XG4gICAgICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gQ2xpZW50IG1lc3NhZ2UgY29zdCBlc3RpbWF0ZTogJCR7bWVzc2FnZUNvc3QudG9GaXhlZCg2KX0gKCR7aW5wdXRUb2tlbnN9IGlucHV0IHRva2VucywgJHtvdXRwdXRUb2tlbnN9IG91dHB1dCB0b2tlbnMpYCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gVXBkYXRlIHRvdGFsIGNvbnZlcnNhdGlvbiBjb3N0XG4gICAgICAgICAgc2V0Q29udmVyc2F0aW9uQ29zdChwcmV2Q29zdCA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdDb3N0ID0gcHJldkNvc3QgKyBtZXNzYWdlQ29zdDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbQ2hhdENvbnRleHRdIFVwZGF0ZWQgY29udmVyc2F0aW9uIGNvc3Q6ICQke25ld0Nvc3QudG9GaXhlZCg2KX1gKTtcbiAgICAgICAgICAgIHJldHVybiBuZXdDb3N0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIElmIHdlIGNhbid0IGVzdGltYXRlIGNvc3QsIGp1c3QgbG9nIGEgbWVzc2FnZVxuICAgICAgICAgIGNvbnNvbGUubG9nKCdbQ2hhdENvbnRleHRdIFVuYWJsZSB0byBlc3RpbWF0ZSBtZXNzYWdlIGNvc3QgLSBpbnN1ZmZpY2llbnQgZGF0YScpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChjb3N0RXJyb3IpIHtcbiAgICAgICAgLy8gSWYgYW55dGhpbmcgZ29lcyB3cm9uZyBpbiBjb3N0IGNhbGN1bGF0aW9uLCBqdXN0IGxvZyBhbmQgY29udGludWVcbiAgICAgICAgY29uc29sZS5lcnJvcignW0NoYXRDb250ZXh0XSBFcnJvciBjYWxjdWxhdGluZyBtZXNzYWdlIGNvc3Q6JywgY29zdEVycm9yKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQWRkIEFJIG1lc3NhZ2UgdG8gdGhlIG1lc3NhZ2VzIGFycmF5XG4gICAgICBjb25zb2xlLmxvZygnW0NoYXRDb250ZXh0XSBBZGRpbmcgQUkgcmVzcG9uc2UgdG8gVUknKTtcbiAgICAgIHNldE1lc3NhZ2VzKHByZXZNZXNzYWdlcyA9PiB7XG4gICAgICAgIGNvbnN0IG5ld01lc3NhZ2VzID0gWy4uLnByZXZNZXNzYWdlcywgYWlNZXNzYWdlXTtcbiAgICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gVXBkYXRlZCBtZXNzYWdlcyBhcnJheSBzaXplOiAke25ld01lc3NhZ2VzLmxlbmd0aH1gKTtcbiAgICAgICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gTGF0ZXN0IG1lc3NhZ2UgSUQ6ICR7YWlNZXNzYWdlLmlkfWApO1xuICAgICAgICByZXR1cm4gbmV3TWVzc2FnZXM7XG4gICAgICB9KTtcblxuICAgICAgLy8gU2V0IGRlYnVnIGluZm8gaWYgcmVxdWVzdGVkIGFuZCByZWNlaXZlZFxuICAgICAgaWYgKHJlcXVlc3REZWJ1Z0luZm8gJiYgcmVzcG9uc2UuZGVidWdJbmZvKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbQ2hhdENvbnRleHRdIFNldHRpbmcgZGVidWcgaW5mbyBpbiBzdGF0ZScpO1xuICAgICAgICBzZXREZWJ1Z0luZm8ocmVzcG9uc2UuZGVidWdJbmZvKTtcbiAgICAgIH1cblxuICAgIH0gY2F0Y2ggKGVycjogYW55KSB7IC8vIFR5cGUgZXJyb3IgZm9yIGJldHRlciBoYW5kbGluZ1xuICAgICAgY29uc29sZS5lcnJvcignW0NoYXRDb250ZXh0XSBFcnJvciBzZW5kaW5nIG1lc3NhZ2U6JywgZXJyKTtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVyci5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSB8fCBlcnIubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGdldCBhIHJlc3BvbnNlIGZyb20gdGhlIEFJLiBQbGVhc2UgdHJ5IGFnYWluLic7XG4gICAgICBjb25zb2xlLmVycm9yKGBbQ2hhdENvbnRleHRdIFNldHRpbmcgZXJyb3I6ICR7ZXJyb3JNZXNzYWdlfWApO1xuICAgICAgc2V0RXJyb3IoZXJyb3JNZXNzYWdlKTtcblxuICAgICAgLy8gT3B0aW9uYWxseSByZW1vdmUgdGhlIHVzZXIgbWVzc2FnZSBpZiB0aGUgQVBJIGNhbGwgZmFpbGVkXG4gICAgICAvLyBzZXRNZXNzYWdlcyhwcmV2TWVzc2FnZXMgPT4gcHJldk1lc3NhZ2VzLmZpbHRlcihtc2cgPT4gbXNnLmlkICE9PSB1c2VyTWVzc2FnZUlkKSk7XG5cbiAgICB9IGZpbmFsbHkge1xuICAgICAgY29uc29sZS5sb2coJ1tDaGF0Q29udGV4dF0gTWVzc2FnZSBleGNoYW5nZSBjb21wbGV0ZSwgc2V0dGluZyBsb2FkaW5nIHRvIGZhbHNlJyk7XG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICB9XG4gIH07XG4gIFxuICAvLyBDbGVhciBhbGwgbWVzc2FnZXNcbiAgY29uc3QgY2xlYXJNZXNzYWdlcyA9ICgpID0+IHtcbiAgICBzZXRNZXNzYWdlcyhbXSk7XG4gICAgc2V0RXJyb3IobnVsbCk7XG4gICAgc2V0RGVidWdJbmZvKG51bGwpOyAvLyBDbGVhciBkZWJ1ZyBpbmZvIGFzIHdlbGxcbiAgfTtcbiAgXG4gIC8vIFN0YXJ0IGEgbmV3IGNvbnZlcnNhdGlvblxuICBjb25zdCBzdGFydE5ld0NvbnZlcnNhdGlvbiA9ICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnW0NoYXRDb250ZXh0XSBTdGFydGluZyBuZXcgY29udmVyc2F0aW9uIC0gcmVzZXR0aW5nIHN0YXRlJyk7XG4gICAgY29uc29sZS5sb2coYFtDaGF0Q29udGV4dF0gUHJldmlvdXMgY29udmVyc2F0aW9uIElEOiAke2NvbnZlcnNhdGlvbklkIHx8ICdOb25lJ31gKTtcbiAgICBcbiAgICBzZXRDb252ZXJzYXRpb25JZChudWxsKTsgLy8gVGhpcyB3aWxsIHNpZ25hbCB0aGUgYmFja2VuZCB0byBzdGFydCBhIGZyZXNoIGNvbnZlcnNhdGlvblxuICAgIHNldE1lc3NhZ2VzKFtdKTsgLy8gQ2xlYXIgdGhlIFVJXG4gICAgc2V0RXJyb3IobnVsbCk7XG4gICAgc2V0RGVidWdJbmZvKG51bGwpO1xuICAgIHNldENvbnZlcnNhdGlvbkNvc3QoMCk7IC8vIFJlc2V0IGNvbnZlcnNhdGlvbiBjb3N0XG4gICAgLy8gS2VlcCB0aGUgY3VycmVudCBtb2RlbCBpbmZvIGZvciB0aGUgbmV4dCBjb252ZXJzYXRpb25cbiAgICBcbiAgICBjb25zb2xlLmxvZygnW0NoYXRDb250ZXh0XSBTdGF0ZSByZXNldCBjb21wbGV0ZSBmb3IgbmV3IGNvbnZlcnNhdGlvbicpO1xuICB9O1xuICBcbiAgLy8gQ29udGV4dCB2YWx1ZVxuICBjb25zdCB2YWx1ZSA9IHtcbiAgICBtZXNzYWdlcyxcbiAgICBsb2FkaW5nLFxuICAgIGRlYnVnSW5mbywgLy8gRXhwb3NlIGRlYnVnSW5mb1xuICAgIGVycm9yLFxuICAgIGNvbnZlcnNhdGlvbklkLCAvLyBFeHBvc2UgY29udmVyc2F0aW9uSWRcbiAgICBjdXJyZW50TW9kZWwsIC8vIEV4cG9zZSBjdXJyZW50IG1vZGVsXG4gICAgY29udmVyc2F0aW9uQ29zdCwgLy8gRXhwb3NlIGNvbnZlcnNhdGlvbiBjb3N0XG4gICAgc2VuZE1lc3NhZ2UsXG4gICAgY2xlYXJNZXNzYWdlcyxcbiAgICBzdGFydE5ld0NvbnZlcnNhdGlvbiwgLy8gRXhwb3NlIG1ldGhvZCB0byBzdGFydCBhIG5ldyBjb252ZXJzYXRpb25cbiAgfTtcbiAgXG4gIHJldHVybiA8Q2hhdENvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3ZhbHVlfT57Y2hpbGRyZW59PC9DaGF0Q29udGV4dC5Qcm92aWRlcj47XG59O1xuXG4vLyBDdXN0b20gaG9vayB0byB1c2UgdGhlIGNoYXQgY29udGV4dFxuZXhwb3J0IGNvbnN0IHVzZUNoYXRDb250ZXh0ID0gKCkgPT4gdXNlQ29udGV4dChDaGF0Q29udGV4dCk7XG5cbmV4cG9ydCBkZWZhdWx0IENoYXRDb250ZXh0OyAiXSwibmFtZXMiOlsiUmVhY3QiLCJjcmVhdGVDb250ZXh0IiwidXNlU3RhdGUiLCJ1c2VDb250ZXh0IiwidXNlQXBpIiwiQ2hhdENvbnRleHQiLCJtZXNzYWdlcyIsImxvYWRpbmciLCJlcnJvciIsImRlYnVnSW5mbyIsImNvbnZlcnNhdGlvbklkIiwiY3VycmVudE1vZGVsIiwiY29udmVyc2F0aW9uQ29zdCIsInNlbmRNZXNzYWdlIiwiY2xlYXJNZXNzYWdlcyIsInN0YXJ0TmV3Q29udmVyc2F0aW9uIiwiY2FsY3VsYXRlQ29zdCIsIm1vZGVsTmFtZSIsImlucHV0VG9rZW5zIiwib3V0cHV0VG9rZW5zIiwiaW5wdXRNaWxsaW9ucyIsIm91dHB1dE1pbGxpb25zIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImlucHV0UmF0ZSIsIm91dHB1dFJhdGUiLCJlc3RpbWF0ZVRva2VuQ291bnQiLCJ0ZXh0Iiwid29yZENvdW50Iiwic3BsaXQiLCJsZW5ndGgiLCJNYXRoIiwiY2VpbCIsIkNoYXRQcm92aWRlciIsImNoaWxkcmVuIiwic2V0TWVzc2FnZXMiLCJzZXRMb2FkaW5nIiwic2V0RXJyb3IiLCJzZXREZWJ1Z0luZm8iLCJzZXRDb252ZXJzYXRpb25JZCIsInNldEN1cnJlbnRNb2RlbCIsInNldENvbnZlcnNhdGlvbkNvc3QiLCJhcGkiLCJjb250ZW50Iiwib3ZlcnJpZGVQcm9tcHRJZCIsInJlcXVlc3REZWJ1Z0luZm8iLCJjb25zb2xlIiwibG9nIiwicmVzcG9uc2UiLCJ1c2VyTWVzc2FnZUlkIiwiRGF0ZSIsIm5vdyIsInJhbmRvbSIsInRvU3RyaW5nIiwic2xpY2UiLCJlc3RpbWF0ZWRVc2VyVG9rZW5zIiwidXNlck1lc3NhZ2UiLCJpZCIsInJvbGUiLCJjcmVhdGVkQXQiLCJ0b0lTT1N0cmluZyIsInRva2VuQ291bnQiLCJpbnB1dCIsInVuZGVmaW5lZCIsInByZXZNZXNzYWdlcyIsIm5ld01lc3NhZ2VzIiwiZW5oYW5jZWREZWJ1Z0luZm8iLCJjaGF0IiwicmVwbHkiLCJCb29sZWFuIiwiaXNOZXdDb252ZXJzYXRpb24iLCJzdWJzdHJpbmciLCJzeXN0ZW1Qcm9tcHRVc2VkTmFtZSIsImNvbnZlcnNhdGlvbiIsIm1lc3NhZ2VDb3VudCIsInN1bW1hcnlDb250ZXh0SW5qZWN0ZWQiLCJlc3RpbWF0ZWRPdXRwdXRUb2tlbnMiLCJhaU1lc3NhZ2UiLCJvdXRwdXQiLCJjb3N0RXN0aW1hdGUiLCJtZXNzYWdlQ29zdCIsInRvRml4ZWQiLCJ0b2tlblVzYWdlIiwicHJvbXB0VG9rZW5zIiwiY29tcGxldGlvblRva2VucyIsInByZXZDb3N0IiwibmV3Q29zdCIsIm1vZGVsVG9Vc2UiLCJjb3N0RXJyb3IiLCJlcnIiLCJlcnJvck1lc3NhZ2UiLCJkYXRhIiwibWVzc2FnZSIsInZhbHVlIiwiUHJvdmlkZXIiLCJ1c2VDaGF0Q29udGV4dCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/context/ChatContext.tsx\n"));

/***/ })

});